# 智能分隔符识别说明

## 功能概述

名字生成器现在支持智能识别多种分隔符，可以自动解析粘贴的名字列表，无需手动格式化。

## 识别逻辑（升级版）

系统会自动检测输入内容的语言类型（中文/日韩/英文），并应用相应的分隔符规则：

### 日韩模式（新增！）

**触发条件**：
- 包含日文假名（平假名或片假名）
- 或包含韩文字符
- 或包含汉字且有空格分隔的词组，且平均行长度 > 5

**处理方式**：
- ✅ **保留空格**（因为日韩名字格式为"姓 名"）
- 只用换行、逗号、分号、顿号等作为分隔符

**支持的分隔符**：
- ✅ 换行符 (`\n`, `\r`)
- ✅ 逗号 (`,` 和 `，`)
- ✅ 分号 (`;` 和 `；`)
- ✅ 顿号 (`、`)
- ✅ 制表符 (`\t`)
- ✅ 竖线 (`|` 和 `｜`)
- ✅ 斜杠 (`/` 和 `\`)
- ❌ **不分割空格**（保留完整名字）

**示例输入**：
```
山田 太郎
佐藤 花子,田中 健;鈴木 美咲
伊藤 翔、小林 愛
```

**解析结果**：
```
山田 太郎
佐藤 花子
田中 健
鈴木 美咲
伊藤 翔
小林 愛
```

**韩文示例**：
```
김 민준,이 서연;박 지우
최 하은、정 도윤
```

**解析结果**：
```
김 민준
이 서연
박 지우
최 하은
정 도윤
```

### 中文模式

**触发条件**：
- 包含汉字（占比 > 30%）
- 且不符合日韩模式的条件

**处理方式**：
- 空格作为分隔符（中文名字通常连写，没有空格）

**支持的分隔符**：
- ✅ 换行符 (`\n`, `\r`)
- ✅ **空格**
- ✅ 逗号 (`,` 和 `，`)
- ✅ 顿号 (`、`)
- ✅ 分号 (`;` 和 `；`)
- ✅ 制表符 (`\t`)
- ✅ 竖线 (`|` 和 `｜`)
- ✅ 斜杠 (`/` 和 `\`)

**示例输入**：
```
张三,李四、王五 刘六
赵七；钱八|孙九/周十
```

**解析结果**：
```
张三
李四
王五
刘六
赵七
钱八
孙九
周十
```

### 英文模式

**触发条件**：
- 不包含汉字
- 或汉字占比很少（≤ 30%）

**处理方式**：
- **保留空格**（英文名字格式为"First Last"）

**支持的分隔符**：
- ✅ 换行符 (`\n`, `\r`)
- ✅ 逗号 (`,` 和 `，`)
- ✅ 分号 (`;` 和 `；`)
- ✅ 制表符 (`\t`)
- ✅ 竖线 (`|` 和 `｜`)
- ✅ 斜杠 (`/` 和 `\`)
- ❌ **不分割空格**

**示例输入**：
```
John Smith, Jane Doe; Bob Lee
Alice Wang|Charlie Brown/David Miller
```

**解析结果**：
```
John Smith
Jane Doe
Bob Lee
Alice Wang
Charlie Brown
David Miller
```

## 使用场景

### 场景1：从Excel复制
```
1. 在Excel中选中一列名字
2. 复制（Ctrl+C）
3. 粘贴到文本框
4. 自动识别换行符，解析成功
```

### 场景2：日文名字生成后编辑
```
生成日文名字：
山田 太郎
佐藤 花子
田中 健

✅ 空格被保留，名字完整
```

### 场景3：混合分隔符
```
输入：张三、李四 王五,赵六；钱七
自动解析为5个独立的名字
支持在同一行使用多种分隔符
```

### 场景4：韩文名字
```
输入：김 민준, 이 서연; 박 지우
✅ 保留空格，正确识别为3个完整的韩文名
```

### 场景5：制表符分隔
```
从TSV文件或表格复制的数据
自动识别制表符，正确分割
```

## 智能检测规则

系统按以下优先级检测：

1. **检测日文假名** - 如果有平假名或片假名 → 日韩模式
2. **检测韩文字符** - 如果有韩文字符 → 日韩模式
3. **检测汉字+空格** - 如果有汉字且有空格分隔的词 → 日韩模式
4. **检测纯汉字** - 如果汉字占比高但无上述特征 → 中文模式
5. **默认** - 其他情况 → 英文模式

## 自动规范化

解析后的名字会自动：
1. **去除首尾空格**：`" 张三 "` → `"张三"`
2. **保留名字内部空格**：`"山田 太郎"` → `"山田 太郎"`（日韩模式）
3. **过滤空项**：自动忽略连续分隔符产生的空字符串
4. **统一格式**：解析后统一用换行符在文本框中显示

## 实际测试示例

### 测试1：中文名字混合分隔符
**输入**：
```
王明华,李建国、张志强 刘晓明；陈秀英|杨丽华/黄国强
```

**输出**：
```
王明华
李建国
张志强
刘晓明
陈秀英
杨丽华
黄国强
```

### 测试2：日文名字保留空格 ✨新增
**输入**：
```
山田 太郎,佐藤 花子;田中 健
伊藤 翔、小林 愛|鈴木 美咲
```

**输出**：
```
山田 太郎
佐藤 花子
田中 健
伊藤 翔
小林 愛
鈴木 美咲
```

### 测试3：韩文名字保留空格 ✨新增
**输入**：
```
김 민준,이 서연;박 지우
최 하은、정 도윤
```

**输出**：
```
김 민준
이 서연
박 지우
최 하은
정 도윤
```

### 测试4：英文名字保留空格
**输入**：
```
James Smith, Mary Johnson; John Williams | Robert Jones / Jennifer Garcia
```

**输出**：
```
James Smith
Mary Johnson
John Williams
Robert Jones
Jennifer Garcia
```

### 测试5：中英日韩混合（按检测优先级）
**输入**：
```
张三,山田 太郎,John Smith
김 민준;李四
```

**输出**：
```
张三
山田 太郎
John Smith
김 민준
李四
```
*注意：由于包含日文假名/韩文，会按日韩模式处理，所以所有空格都被保留*

## 技术实现

```javascript
function parseNames(inputText) {
    // 检测日文假名
    const hasJapaneseKana = /[\u3040-\u309F\u30A0-\u30FF]/.test(inputText);
    
    // 检测韩文字符
    const hasKoreanChars = /[\uAC00-\uD7AF]/.test(inputText);
    
    // 检测汉字
    const chineseChars = inputText.match(/[\u4e00-\u9fa5]/g);
    const hasChineseChars = chineseChars && chineseChars.length > inputText.length * 0.3;
    
    // 检测是否有空格分隔的词组
    const hasSpaceSeparatedWords = /\S+\s+\S+/.test(inputText);
    
    if (hasJapaneseKana || hasKoreanChars || 
        (hasChineseChars && hasSpaceSeparatedWords)) {
        // 日韩模式：保留空格
        return inputText.split(/[\n\r,;，；\t|｜、\/\\]+/)
            .map(name => name.trim())
            .filter(name => name.length > 0);
    } else if (hasChineseChars) {
        // 中文模式：空格也是分隔符
        return inputText.split(/[\n\r\s,，、;；\t|｜\/\\]+/)
            .map(name => name.trim())
            .filter(name => name.length > 0);
    } else {
        // 英文模式：保留空格
        return inputText.split(/[\n\r,;，；\t|｜\/\\]+/)
            .map(name => name.trim())
            .filter(name => name.length > 0);
    }
}
```

## 常见问题

**Q: 为什么日文名字之前被分成了两部分？**
A: 之前的版本没有检测日文假名，把日文当作中文处理，空格被分割了。现在已修复！

**Q: 韩文名字会正确识别吗？**
A: 是的！系统会检测韩文字符（U+AC00-U+D7AF），自动保留空格。

**Q: 如果同时包含中文、日文、韩文怎么办？**
A: 系统按优先级检测：日文假名 > 韩文字符 > 汉字+空格。只要包含日韩字符，就会保留所有空格。

**Q: 纯中文名字会受影响吗？**
A: 不会！纯中文名字（如"张三 李四"）仍然会按中文模式处理，空格作为分隔符。

**Q: 我想手动控制是否用空格分割怎么办？**
A: 目前是自动识别。如果需要精确控制：
- 纯中文：可以用任意分隔符
- 日韩/英文：避免用空格，用逗号、分号或换行

**Q: 支持自定义分隔符吗？**
A: 目前支持常见的分隔符。如果有特殊需求，可以先在外部文本编辑器中替换成支持的分隔符。

**Q: 解析后的名字顺序会变吗？**
A: 不会，解析只是分割，不会改变顺序。除非你点击"应用排序"按钮。

## 优势

1. ✨ **智能识别**：自动判断中文/日韩/英文
2. 🚀 **多格式支持**：兼容Excel、网页、文本等多种来源
3. 🎯 **精确解析**：日韩/英文名正确保留空格
4. 🔧 **自动清理**：去除空格、过滤空项
5. 📋 **所见即所得**：解析后立即在文本框规范化显示
6. 🌏 **多语言友好**：完美支持中英日韩等语言

---

享受智能分隔符识别带来的便利！现在日韩名字也能正确识别了！🎉

## 使用场景

### 场景1：从Excel复制
```
1. 在Excel中选中一列名字
2. 复制（Ctrl+C）
3. 粘贴到文本框
4. 自动识别换行符，解析成功
```

### 场景2：从逗号分隔的文本
```
输入：张三,李四,王五,赵六
自动解析为4个独立的名字
```

### 场景3：混合分隔符
```
输入：张三、李四 王五,赵六；钱七
自动解析为5个独立的名字
支持在同一行使用多种分隔符
```

### 场景4：从网页复制英文名
```
输入：John Smith, Jane Doe, Bob Lee
自动保留空格，解析为3个完整的英文名
```

### 场景5：制表符分隔
```
从TSV文件或表格复制的数据
自动识别制表符，正确分割
```

## 自动规范化

解析后的名字会自动：
1. **去除首尾空格**：`" 张三 "` → `"张三"`
2. **过滤空项**：自动忽略连续分隔符产生的空字符串
3. **统一格式**：解析后统一用换行符在文本框中显示

## 实际测试示例

### 测试1：中文名字混合分隔符
**输入**：
```
王明华,李建国、张志强 刘晓明；陈秀英|杨丽华/黄国强
```

**输出**：
```
王明华
李建国
张志强
刘晓明
陈秀英
杨丽华
黄国强
```

### 测试2：英文名字保留空格
**输入**：
```
James Smith, Mary Johnson; John Williams | Robert Jones / Jennifer Garcia
```

**输出**：
```
James Smith
Mary Johnson
John Williams
Robert Jones
Jennifer Garcia
```

### 测试3：中英文混合（按中文规则）
**输入**：
```
张三 Tom Smith,李四、Jane Doe;王五|Bob Lee
```

**输出**：
```
张三
Tom
Smith
李四
Jane
Doe
王五
Bob
Lee
```
*注意：因为中文字符占比高，会按中文规则分割，所以空格也作为分隔符*

## 技术实现

```javascript
function parseNames(inputText) {
    // 检测语言类型
    const chineseChars = inputText.match(/[\u4e00-\u9fa5]/g);
    const isChinese = chineseChars && chineseChars.length > inputText.length * 0.3;
    
    if (isChinese) {
        // 中文模式：所有常见分隔符
        return inputText.split(/[\n\r\s,，、;；\t|｜\/\\]+/)
            .map(name => name.trim())
            .filter(name => name.length > 0);
    } else {
        // 英文模式：不包含空格
        return inputText.split(/[\n\r,;，；\t|｜\/\\]+/)
            .map(name => name.trim())
            .filter(name => name.length > 0);
    }
}
```

## 常见问题

**Q: 为什么英文名字被分成了两部分？**
A: 如果文本中中文字符较多（>30%），会触发中文模式，空格会作为分隔符。建议分开处理纯中文和纯英文的名字列表。

**Q: 我想手动控制是否用空格分割怎么办？**
A: 目前是自动识别，如果需要精确控制，建议：
- 纯中文名字：可以用任意分隔符
- 纯英文名字：避免用空格，用逗号、分号或换行

**Q: 支持自定义分隔符吗？**
A: 目前支持常见的分隔符。如果有特殊需求，可以先在外部文本编辑器中替换成支持的分隔符。

**Q: 解析后的名字顺序会变吗？**
A: 不会，解析只是分割，不会改变顺序。除非你点击"应用排序"按钮。

## 优势

1. ✨ **智能识别**：自动判断语言类型
2. 🚀 **多格式支持**：兼容Excel、网页、文本等多种来源
3. 🎯 **精确解析**：英文名正确保留空格
4. 🔧 **自动清理**：去除空格、过滤空项
5. 📋 **所见即所得**：解析后立即在文本框规范化显示

---

享受智能分隔符识别带来的便利！ 🎉

